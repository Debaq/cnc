

            <!-- Main Content -->
            <main class="flex-1 flex flex-col overflow-hidden">

                <!-- Hidden file input for SVG -->
                <input type="file" accept=".svg" class="hidden"
                    x-ref="svgInput" @change="handleSVGUpload">

                <!-- Workspace Container -->
                <div class="flex-1 flex overflow-hidden">

                    <!-- Canvas Panel -->
                    <div class="flex-1 flex flex-col bg-purple-bg">

                        <!-- Canvas Toolbar -->
                        <div
                            class="bg-white border-b border-gray-200 px-6 py-3 flex items-center justify-between">
                            <!-- View Mode Selector -->
                            <div class="flex items-center gap-2 mr-4">
                                <button @click="viewMode = 'svg'; currentTab = 'elements'"
                                    :class="viewMode === 'svg' ? 'bg-purple-medium text-white' : 'bg-gray-100 text-gray-700'"
                                    class="px-3 py-1 rounded-lg text-sm transition">
                                    üìê Dise√±o
                                </button>
                                <button @click="switchTo3DView()"
                                    :class="viewMode === '3d' ? 'bg-purple-medium text-white' : 'bg-gray-100 text-gray-700'"
                                    :disabled="!gcodeGenerated"
                                    class="px-3 py-1 rounded-lg text-sm transition disabled:opacity-50 disabled:cursor-not-allowed">
                                    üé¨ Vista 3D
                                </button>
                            </div>

                            <div class="flex items-center gap-2">
                                <div class="flex items-center gap-3">
                                    <!-- Position controls -->
                                    <div class="flex items-center gap-1">
                                        <span class="text-xs text-gray-600 font-semibold">X:</span>
                                        <input type="number"
                                            x-model.number="svgX"
                                            @input="updateSVGPosition()"
                                            step="1"
                                            class="w-16 px-2 py-1 border border-gray-300 rounded text-xs text-right">
                                        <span class="text-xs text-gray-500">mm</span>
                                    </div>

                                    <div class="flex items-center gap-1">
                                        <span class="text-xs text-gray-600 font-semibold">Y:</span>
                                        <input type="number"
                                            x-model.number="svgY"
                                            @input="updateSVGPosition()"
                                            step="1"
                                            class="w-16 px-2 py-1 border border-gray-300 rounded text-xs text-right">
                                        <span class="text-xs text-gray-500">mm</span>
                                    </div>

                                    <div class="h-6 w-px bg-gray-300"></div>

                                    <!-- Size controls -->
                                    <div class="flex items-center gap-1">
                                        <span
                                            class="text-xs text-gray-600">W:</span>
                                        <input type="number"
                                            x-model.number="svgWidth"
                                            @input="updateSVGWidth()"
                                            step="1"
                                            min="1"
                                            class="w-16 px-2 py-1 border border-gray-300 rounded text-xs text-right">
                                        <span
                                            class="text-xs text-gray-500">mm</span>
                                    </div>

                                    <button
                                        @click="proportionalScale = !proportionalScale"
                                        :class="proportionalScale ? 'bg-purple-medium text-white' : 'bg-gray-200'"
                                        class="px-2 py-1 rounded transition"
                                        title="Escala proporcional">
                                        <span
                                            x-show="proportionalScale">üîí</span>
                                        <span
                                            x-show="!proportionalScale">üîì</span>
                                    </button>

                                    <div class="flex items-center gap-1">
                                        <span
                                            class="text-xs text-gray-600">H:</span>
                                        <input type="number"
                                            x-model.number="svgHeight"
                                            @input="updateSVGHeight()"
                                            step="1"
                                            min="1"
                                            class="w-16 px-2 py-1 border border-gray-300 rounded text-xs text-right">
                                        <span
                                            class="text-xs text-gray-500">mm</span>
                                    </div>
                                </div>
                            </div>

                            <div
                                class="flex items-center gap-4 text-sm text-gray-600">
                                <span>√Årea: <span x-text="workAreaSize"></span>
                                    mm</span>
                                <button @click="openModal('workArea')"
                                    class="hover:text-purple-medium">‚úèÔ∏è</button>
                            </div>

                            <div class="flex items-center gap-2">
                                <!-- Herramientas de Transformaci√≥n -->
                                <button @click="flipHorizontal"
                                    :disabled="!svgLoaded && elements.length === 0"
                                    class="px-3 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg transition text-sm disabled:opacity-50"
                                    title="Reflejar horizontalmente">
                                    ‚ÜîÔ∏è
                                </button>
                                <button @click="flipVertical"
                                    :disabled="!svgLoaded && elements.length === 0"
                                    class="px-3 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg transition text-sm disabled:opacity-50"
                                    title="Reflejar verticalmente">
                                    ‚ÜïÔ∏è
                                </button>
                                <div class="h-6 w-px bg-gray-300 mx-1"></div>

                                <!-- Herramientas de Vista -->
                                <button @click="zoomIn"
                                    class="px-3 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg transition text-sm">
                                    üîç+
                                </button>
                                <button @click="zoomOut"
                                    class="px-3 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg transition text-sm">
                                    üîç-
                                </button>
                                <button @click="fitView"
                                    class="px-3 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg transition text-sm"
                                    title="Centrar √°rea de trabajo">
                                    üéØ
                                </button>
                            </div>
                        </div>

                        <!-- Canvas Area - SVG & 3D Views -->
                        <div class="flex-1 p-4 relative overflow-hidden">
                            <!-- SVG Canvas -->
                            <div x-show="viewMode === 'svg'" style="width: 100%; height: 100%;">
                                <canvas x-ref="canvas"
                                    class="rounded-lg shadow-lg" style="display: block;"></canvas>
                            </div>

                            <!-- 3D Viewer Canvas -->
                            <div x-show="viewMode === '3d'" class="w-full h-full bg-gray-900 rounded-lg shadow-lg relative">
                                <canvas x-ref="viewer3d"
                                    class="w-full h-full rounded-lg"></canvas>

                                <!-- Loading overlay for 3D view -->
                                <div x-show="!gcodeGenerated"
                                    class="absolute inset-0 flex items-center justify-center bg-gray-900 bg-opacity-90 rounded-lg">
                                    <div class="text-center text-gray-400">
                                        <div class="text-6xl mb-4">üé¨</div>
                                        <p class="text-lg font-semibold">Vista 3D no disponible</p>
                                        <p class="text-sm mt-2">Genera G-code primero para ver</p>
                                        <p class="text-sm">la visualizaci√≥n 3D de las trayectorias</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Canvas Footer -->
                        <div
                            class="bg-white border-t border-gray-200 px-6 py-3 flex items-center justify-between text-sm text-gray-600">
                            <div class="flex items-center gap-6">
                                <span>Posici√≥n: <span
                                        x-text="svgPosition"></span></span>
                                <span>Escala: <span
                                        x-text="svgScale"></span></span>
                                <span>Rotaci√≥n: <span
                                        x-text="svgRotation"></span></span>
                            </div>
                        </div>
                    </div>

                    <!-- Right Panel -->
                    <div
                        class="w-96 bg-white border-l border-gray-200 flex flex-col">

                        <!-- Tabs -->
                        <div class="flex border-b border-gray-200 bg-gray-50">
                            <template x-for="tab in tabs" :key="tab.id">
                                <button @click="currentTab = tab.id"
                                    :class="currentTab === tab.id ? 'border-b-2 border-purple-medium bg-white font-semibold' : 'text-gray-600'"
                                    class="flex-1 px-4 py-3 text-sm transition"
                                    x-text="tab.icon + ' ' + tab.name">
                                </button>
                            </template>
                        </div>

                        <!-- Tab Content -->
                        <div class="flex-1 overflow-y-auto p-6">

                            <!-- Elements Tab -->
<!-- Reemplazar la secci√≥n de elementos en el tab 'elements' -->
<div x-show="currentTab === 'elements'" class="space-y-4">
    <!-- Global Config -->
    <div class="bg-purple-ultra-pale rounded-lg p-4">
        <div class="flex items-center justify-between mb-3">
            <h3 class="text-sm font-semibold text-purple-dark">‚öôÔ∏è Configuraci√≥n Global</h3>
            <button @click="applyGlobalConfigToAll()"
                class="text-xs px-2 py-1 bg-purple-medium hover:bg-purple-dark text-white rounded transition"
                title="Aplicar esta configuraci√≥n a todos los elementos">
                Aplicar a Todos
            </button>
        </div>

        <div class="space-y-3">
            <!-- Tipo de Operaci√≥n -->
            <div>
                <label class="text-xs text-gray-600 font-medium">Tipo de Operaci√≥n:</label>
                <select x-model="globalConfig.operationType"
                    class="w-full px-2 py-1.5 border border-gray-300 rounded text-sm mt-1">
                    <option value="cnc">üîß CNC Fresado</option>
                    <option value="laser">‚ö° L√°ser</option>
                    <option value="plotter">‚úÇÔ∏è Plotter Corte</option>
                    <option value="pencil">‚úèÔ∏è L√°piz/Marcador</option>
                </select>
            </div>

            <!-- Herramienta (para CNC, Plotter, Pencil) -->
            <div x-show="globalConfig.operationType !== 'laser'">
                <label class="text-xs text-gray-600 font-medium">Herramienta:</label>
                <select x-model="globalConfig.tool"
                    class="w-full px-2 py-1.5 border border-gray-300 rounded text-sm mt-1">
                    <option value="">Sin herramienta</option>
                    <template x-for="tool in tools.filter(t =>
                        (globalConfig.operationType === 'cnc' && t.category === 'cnc') ||
                        (globalConfig.operationType === 'plotter' && t.category === 'plotter') ||
                        (globalConfig.operationType === 'pencil' && t.category === 'pencil')
                    )" :key="tool.id">
                        <option :value="tool.name" x-text="tool.name"></option>
                    </template>
                </select>
            </div>

            <!-- Par√°metros espec√≠ficos de CNC -->
            <template x-if="globalConfig.operationType === 'cnc'">
                <div class="space-y-3 pt-2 border-t border-purple-pale">
                    <!-- Tipo de Trabajo -->
                    <div>
                        <label class="text-xs text-gray-600 font-medium">Tipo de Trabajo:</label>
                        <select x-model="globalConfig.workType"
                            class="w-full px-2 py-1.5 border border-gray-300 rounded text-sm mt-1">
                            <option value="outline">Contorno (sobre l√≠nea)</option>
                            <option value="inside">Interior (por dentro)</option>
                            <option value="outside">Exterior (por fuera)</option>
                            <option value="pocket">Cajeado (vaciar interior)</option>
                        </select>
                    </div>

                    <!-- Compensaci√≥n de Herramienta -->
                    <div>
                        <label class="text-xs text-gray-600 font-medium">Compensaci√≥n:</label>
                        <select x-model="globalConfig.compensation"
                            class="w-full px-2 py-1.5 border border-gray-300 rounded text-sm mt-1">
                            <option value="center">Centro</option>
                            <option value="inside">Interior</option>
                            <option value="outside">Exterior</option>
                        </select>
                    </div>

                    <!-- Profundidad y Paso -->
                    <div class="grid grid-cols-2 gap-2">
                        <div>
                            <label class="text-xs text-gray-600">Profundidad (mm):</label>
                            <input type="number" x-model.number="globalConfig.depth" step="0.5"
                                class="w-full px-2 py-1 border border-gray-300 rounded text-sm mt-1">
                        </div>
                        <div>
                            <label class="text-xs text-gray-600">Paso/Pasada (mm):</label>
                            <input type="number" x-model.number="globalConfig.depthStep" step="0.1" min="0.1"
                                class="w-full px-2 py-1 border border-gray-300 rounded text-sm mt-1">
                        </div>
                    </div>

                    <!-- Di√°metro de Herramienta -->
                    <div>
                        <label class="text-xs text-gray-600">Di√°metro Herramienta (mm):</label>
                        <input type="number" x-model.number="globalConfig.toolDiameter" step="0.1"
                            class="w-full px-2 py-1 border border-gray-300 rounded text-sm mt-1">
                    </div>

                    <!-- Velocidades CNC -->
                    <div class="grid grid-cols-2 gap-2">
                        <div>
                            <label class="text-xs text-gray-600">Feed (mm/min):</label>
                            <input type="number" x-model.number="globalConfig.feedRate"
                                class="w-full px-2 py-1 border border-gray-300 rounded text-sm mt-1">
                        </div>
                        <div>
                            <label class="text-xs text-gray-600">Plunge (mm/min):</label>
                            <input type="number" x-model.number="globalConfig.plungeRate"
                                class="w-full px-2 py-1 border border-gray-300 rounded text-sm mt-1">
                        </div>
                    </div>

                    <div>
                        <label class="text-xs text-gray-600">Spindle RPM:</label>
                        <input type="number" x-model.number="globalConfig.spindleRPM"
                            class="w-full px-2 py-1 border border-gray-300 rounded text-sm mt-1">
                    </div>
                </div>
            </template>

            <!-- Par√°metros espec√≠ficos de L√°ser -->
            <template x-if="globalConfig.operationType === 'laser'">
                <div class="space-y-3 pt-2 border-t border-purple-pale">
                    <div class="grid grid-cols-2 gap-2">
                        <div>
                            <label class="text-xs text-gray-600">Potencia (%):</label>
                            <input type="number" x-model.number="globalConfig.laserPower"
                                min="0" max="100"
                                class="w-full px-2 py-1 border border-gray-300 rounded text-sm mt-1">
                        </div>
                        <div>
                            <label class="text-xs text-gray-600">Pasadas:</label>
                            <input type="number" x-model.number="globalConfig.passes" min="1"
                                class="w-full px-2 py-1 border border-gray-300 rounded text-sm mt-1">
                        </div>
                    </div>
                    <div>
                        <label class="text-xs text-gray-600">Velocidad (mm/min):</label>
                        <input type="number" x-model.number="globalConfig.feedRate"
                            class="w-full px-2 py-1 border border-gray-300 rounded text-sm mt-1">
                    </div>
                </div>
            </template>

            <!-- Par√°metros espec√≠ficos de Plotter -->
            <template x-if="globalConfig.operationType === 'plotter'">
                <div class="space-y-3 pt-2 border-t border-purple-pale">
                    <div class="grid grid-cols-2 gap-2">
                        <div>
                            <label class="text-xs text-gray-600">Presi√≥n (1-33):</label>
                            <input type="number" x-model.number="globalConfig.pressure"
                                min="1" max="33"
                                class="w-full px-2 py-1 border border-gray-300 rounded text-sm mt-1">
                        </div>
                        <div>
                            <label class="text-xs text-gray-600">Velocidad (mm/s):</label>
                            <input type="number" x-model.number="globalConfig.speed"
                                class="w-full px-2 py-1 border border-gray-300 rounded text-sm mt-1">
                        </div>
                    </div>
                    <div>
                        <label class="text-xs text-gray-600">Pasadas:</label>
                        <input type="number" x-model.number="globalConfig.passes" min="1"
                            class="w-full px-2 py-1 border border-gray-300 rounded text-sm mt-1">
                    </div>
                </div>
            </template>

            <!-- Par√°metros espec√≠ficos de L√°piz -->
            <template x-if="globalConfig.operationType === 'pencil'">
                <div class="space-y-3 pt-2 border-t border-purple-pale">
                    <div class="grid grid-cols-2 gap-2">
                        <div>
                            <label class="text-xs text-gray-600">Presi√≥n Z (mm):</label>
                            <input type="number" x-model.number="globalConfig.pressureZ" step="0.1"
                                class="w-full px-2 py-1 border border-gray-300 rounded text-sm mt-1">
                        </div>
                        <div>
                            <label class="text-xs text-gray-600">Velocidad (mm/min):</label>
                            <input type="number" x-model.number="globalConfig.speed"
                                class="w-full px-2 py-1 border border-gray-300 rounded text-sm mt-1">
                        </div>
                    </div>
                </div>
            </template>
        </div>
    </div>

    <!-- Elements List -->
    <div>
        <div class="flex items-center justify-between mb-3">
            <h3 class="text-sm font-semibold text-purple-dark">üìã Elementos (<span x-text="elements.length"></span>)</h3>
            <!-- Men√∫ Agregar -->
            <div class="relative" x-data="{open: false}">
                <button @click="open = !open"
                    class="flex items-center gap-1 px-3 py-1.5 bg-purple-medium hover:bg-purple-dark text-white rounded-lg text-xs font-medium transition">
                    <span>‚ûï</span>
                    <span>Agregar</span>
                    <span x-text="open ? '‚ñ≤' : '‚ñº'" class="text-xs"></span>
                </button>
                <div x-show="open" @click.away="open = false"
                    x-transition
                    class="absolute right-0 mt-2 w-56 bg-white border border-gray-200 rounded-lg shadow-lg z-50 max-h-96 overflow-y-auto">
                    <button @click="loadSVG(); open = false"
                        class="w-full flex items-center gap-2 px-4 py-2 hover:bg-purple-ultra-pale transition text-sm text-left border-b border-gray-200 font-semibold">
                        <span>üìÅ</span>
                        <span>Cargar SVG</span>
                    </button>

                    <!-- Maker.js Models -->
                    <div class="px-3 py-2 text-xs font-bold text-purple-dark bg-purple-ultra-pale">
                        üî∑ Modelos Maker.js
                    </div>
                    <button @click="addMakerModel('Rectangle'); open = false"
                        class="w-full flex items-center gap-2 px-4 py-2 hover:bg-purple-ultra-pale transition text-sm text-left">
                        <span>‚ñ≠</span>
                        <span>Rect√°ngulo</span>
                    </button>
                    <button @click="addMakerModel('Square'); open = false"
                        class="w-full flex items-center gap-2 px-4 py-2 hover:bg-purple-ultra-pale transition text-sm text-left">
                        <span>‚ñ°</span>
                        <span>Cuadrado</span>
                    </button>
                    <button @click="addMakerModel('RoundRectangle'); open = false"
                        class="w-full flex items-center gap-2 px-4 py-2 hover:bg-purple-ultra-pale transition text-sm text-left">
                        <span>‚ñ¢</span>
                        <span>Rect√°ngulo Redondeado</span>
                    </button>
                    <button @click="addMakerModel('Oval'); open = false"
                        class="w-full flex items-center gap-2 px-4 py-2 hover:bg-purple-ultra-pale transition text-sm text-left">
                        <span>‚¨≠</span>
                        <span>√ìvalo</span>
                    </button>
                    <button @click="addMakerModel('Ellipse'); open = false"
                        class="w-full flex items-center gap-2 px-4 py-2 hover:bg-purple-ultra-pale transition text-sm text-left">
                        <span>‚¨Ø</span>
                        <span>Elipse</span>
                    </button>
                    <button @click="addMakerModel('Ring'); open = false"
                        class="w-full flex items-center gap-2 px-4 py-2 hover:bg-purple-ultra-pale transition text-sm text-left">
                        <span>‚óØ</span>
                        <span>Anillo</span>
                    </button>
                    <button @click="addMakerModel('Polygon'); open = false"
                        class="w-full flex items-center gap-2 px-4 py-2 hover:bg-purple-ultra-pale transition text-sm text-left">
                        <span>‚¨°</span>
                        <span>Pol√≠gono</span>
                    </button>
                    <button @click="addMakerModel('Star'); open = false"
                        class="w-full flex items-center gap-2 px-4 py-2 hover:bg-purple-ultra-pale transition text-sm text-left">
                        <span>‚≠ê</span>
                        <span>Estrella</span>
                    </button>
                    <button @click="addMakerModel('Slot'); open = false"
                        class="w-full flex items-center gap-2 px-4 py-2 hover:bg-purple-ultra-pale transition text-sm text-left">
                        <span>‚¨¨</span>
                        <span>Ranura</span>
                    </button>
                    <button @click="addMakerModel('Dome'); open = false"
                        class="w-full flex items-center gap-2 px-4 py-2 hover:bg-purple-ultra-pale transition text-sm text-left">
                        <span>‚åí</span>
                        <span>Domo</span>
                    </button>
                    <button @click="addMakerModel('BoltCircle'); open = false"
                        class="w-full flex items-center gap-2 px-4 py-2 hover:bg-purple-ultra-pale transition text-sm text-left">
                        <span>‚öôÔ∏è</span>
                        <span>C√≠rculo de Tornillos</span>
                    </button>
                    <button @click="addMakerModel('BoltRectangle'); open = false"
                        class="w-full flex items-center gap-2 px-4 py-2 hover:bg-purple-ultra-pale transition text-sm text-left">
                        <span>‚ñ¶</span>
                        <span>Rect. de Tornillos</span>
                    </button>
                    <button @click="addMakerModel('Text'); open = false"
                        class="w-full flex items-center gap-2 px-4 py-2 hover:bg-purple-ultra-pale transition text-sm text-left">
                        <span>üìù</span>
                        <span>Texto</span>
                    </button>
                </div>
            </div>
        </div>

        <div class="space-y-2 max-h-96 overflow-y-auto">
            <template x-for="element in elements" :key="element.id">
                <div class="border rounded-lg p-2 bg-white">
                    <!-- Element Header -->
                    <div class="flex items-center gap-2 cursor-pointer hover:bg-purple-ultra-pale p-1 rounded"
                         @click="selectElement(element.id)">
                        <button @click.stop="toggleElementVisibility(element.id)"
                            class="text-lg" x-text="element.visible ? 'üëÅÔ∏è' : 'üëÅÔ∏è‚Äçüó®Ô∏è'"></button>
                        <button @click.stop="toggleElementLock(element.id)"
                            class="text-lg" x-text="element.locked ? 'üîí' : 'üîì'"></button>
                        <span class="text-lg"
                            x-text="element.type === 'svg' ? 'üìÅ' : element.type === 'maker' ? 'üî∑' : element.type === 'rect' ? 'üü¶' : element.type === 'circle' ? '‚≠ï' : element.type === 'line' ? '‚ûñ' : '‚ùì'"></span>
                        <span class="flex-1 text-sm font-medium" x-text="element.name"></span>

                        <!-- Bot√≥n expandir config -->
                        <button @click.stop="element.showConfig = !element.showConfig"
                            class="text-xs px-2 py-1 bg-purple-ultra-pale rounded hover:bg-purple-pale">
                            <span x-text="element.showConfig ? 'üîº' : '‚öôÔ∏è'"></span>
                        </button>

                        <button @click.stop="toggleExpandElement(element.id)"
                            x-show="element.type === 'svg'"
                            class="text-xs px-2 py-1 bg-gray-100 rounded"
                            x-text="element.expanded ? 'üîΩ' : 'üìÅ'"></button>
                        <button @click.stop="deleteElement(element.id)"
                            class="text-red-500 hover:text-red-700 text-xs">üóëÔ∏è</button>
                    </div>

                    <!-- Element Config Panel (NUEVO) -->
                    <div x-show="element.showConfig"
                         x-transition
                         class="mt-2 p-3 bg-purple-ultra-pale rounded-lg space-y-2">

                        <!-- Toggle: Usar config global o propia -->
                        <label class="flex items-center gap-2 text-xs cursor-pointer">
                            <input type="checkbox"
                                   :checked="!element.config"
                                   @change="element.config = $event.target.checked ? null : {...globalConfig}">
                            <span class="font-medium">Heredar configuraci√≥n global</span>
                        </label>

                        <!-- Config Form (solo si tiene config propia) -->
                        <div x-show="element.config" class="space-y-2 pt-2 border-t">
                            <!-- Tipo de operaci√≥n -->
                            <div>
                                <label class="text-xs text-gray-600">Operaci√≥n:</label>
                                <select x-model="element.config.operationType"
                                    class="w-full px-2 py-1 border rounded text-xs">
                                    <option value="cnc">CNC Fresado</option>
                                    <option value="laser">L√°ser</option>
                                    <option value="plotter">Plotter Corte</option>
                                    <option value="pencil">L√°piz/Marcador</option>
                                </select>
                            </div>

                            <!-- Herramienta (CNC, Plotter, Pencil) -->
                            <div x-show="element.config?.operationType !== 'laser'">
                                <label class="text-xs text-gray-600">Herramienta:</label>
                                <select x-model="element.config.tool"
                                    class="w-full px-2 py-1 border rounded text-xs">
                                    <option value="">Sin herramienta</option>
                                    <template x-for="tool in tools.filter(t =>
                                        (element.config?.operationType === 'cnc' && t.category === 'cnc') ||
                                        (element.config?.operationType === 'plotter' && t.category === 'plotter') ||
                                        (element.config?.operationType === 'pencil' && t.category === 'pencil')
                                    )" :key="tool.id">
                                        <option :value="tool.name" x-text="tool.name"></option>
                                    </template>
                                </select>
                            </div>

                            <!-- Par√°metros CNC -->
                            <template x-if="element.config?.operationType === 'cnc'">
                                <div class="space-y-2">
                                    <div class="grid grid-cols-2 gap-2">
                                        <div>
                                            <label class="text-xs text-gray-600">Profundidad (mm):</label>
                                            <input type="number" x-model.number="element.config.depth" step="0.5"
                                                class="w-full px-2 py-1 border rounded text-xs">
                                        </div>
                                        <div>
                                            <label class="text-xs text-gray-600">Paso (mm):</label>
                                            <input type="number" x-model.number="element.config.depthStep" step="0.1"
                                                class="w-full px-2 py-1 border rounded text-xs">
                                        </div>
                                    </div>
                                    <div>
                                        <label class="text-xs text-gray-600">Compensaci√≥n:</label>
                                        <select x-model="element.config.compensation"
                                            class="w-full px-2 py-1 border rounded text-xs">
                                            <option value="center">Centro</option>
                                            <option value="inside">Interior</option>
                                            <option value="outside">Exterior</option>
                                        </select>
                                    </div>
                                    <div class="grid grid-cols-2 gap-2">
                                        <div>
                                            <label class="text-xs text-gray-600">Feed (mm/min):</label>
                                            <input type="number" x-model.number="element.config.feedRate"
                                                class="w-full px-2 py-1 border rounded text-xs">
                                        </div>
                                        <div>
                                            <label class="text-xs text-gray-600">RPM:</label>
                                            <input type="number" x-model.number="element.config.spindleRPM"
                                                class="w-full px-2 py-1 border rounded text-xs">
                                        </div>
                                    </div>
                                </div>
                            </template>

                            <!-- Par√°metros L√°ser -->
                            <template x-if="element.config?.operationType === 'laser'">
                                <div class="space-y-2">
                                    <div class="grid grid-cols-2 gap-2">
                                        <div>
                                            <label class="text-xs text-gray-600">Potencia (%):</label>
                                            <input type="number" x-model.number="element.config.laserPower"
                                                min="0" max="100"
                                                class="w-full px-2 py-1 border rounded text-xs">
                                        </div>
                                        <div>
                                            <label class="text-xs text-gray-600">Pasadas:</label>
                                            <input type="number" x-model.number="element.config.passes"
                                                min="1"
                                                class="w-full px-2 py-1 border rounded text-xs">
                                        </div>
                                    </div>
                                    <div>
                                        <label class="text-xs text-gray-600">Velocidad (mm/min):</label>
                                        <input type="number" x-model.number="element.config.feedRate"
                                            class="w-full px-2 py-1 border rounded text-xs">
                                    </div>
                                </div>
                            </template>

                            <!-- Par√°metros Plotter -->
                            <template x-if="element.config?.operationType === 'plotter'">
                                <div class="space-y-2">
                                    <div class="grid grid-cols-2 gap-2">
                                        <div>
                                            <label class="text-xs text-gray-600">Presi√≥n (1-33):</label>
                                            <input type="number" x-model.number="element.config.pressure"
                                                min="1" max="33"
                                                class="w-full px-2 py-1 border rounded text-xs">
                                        </div>
                                        <div>
                                            <label class="text-xs text-gray-600">Velocidad (mm/s):</label>
                                            <input type="number" x-model.number="element.config.speed"
                                                class="w-full px-2 py-1 border rounded text-xs">
                                        </div>
                                    </div>
                                    <div>
                                        <label class="text-xs text-gray-600">Pasadas:</label>
                                        <input type="number" x-model.number="element.config.passes" min="1"
                                            class="w-full px-2 py-1 border rounded text-xs">
                                    </div>
                                </div>
                            </template>

                            <!-- Par√°metros L√°piz -->
                            <template x-if="element.config?.operationType === 'pencil'">
                                <div class="space-y-2">
                                    <div class="grid grid-cols-2 gap-2">
                                        <div>
                                            <label class="text-xs text-gray-600">Presi√≥n Z (mm):</label>
                                            <input type="number" x-model.number="element.config.pressureZ" step="0.1"
                                                class="w-full px-2 py-1 border rounded text-xs">
                                        </div>
                                        <div>
                                            <label class="text-xs text-gray-600">Velocidad (mm/min):</label>
                                            <input type="number" x-model.number="element.config.speed"
                                                class="w-full px-2 py-1 border rounded text-xs">
                                        </div>
                                    </div>
                                </div>
                            </template>

                            <!-- Botones de acci√≥n -->
                            <div class="flex gap-2 pt-2">
                                <button @click="element.config = null; updateConfigStatus()"
                                    class="flex-1 text-xs bg-gray-200 hover:bg-gray-300 px-2 py-1 rounded">
                                    ‚ü≤ Resetear
                                </button>
                                <button @click="element.showConfig = false"
                                    class="flex-1 text-xs bg-purple-medium hover:bg-purple-dark text-white px-2 py-1 rounded">
                                    ‚úì Listo
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Element Config Status (resumen) -->
                    <div class="mt-2 text-xs" x-show="!element.showConfig">
                        <span class="text-gray-600">‚öôÔ∏è </span>
                        <span x-show="!element.config" class="text-gray-500">[hereda global]</span>
                        <span x-show="element.config" class="text-purple-medium font-medium">
                            ‚úèÔ∏è <span x-text="element.config?.operationType || ''"></span>
                        </span>
                        <span x-show="element.config?.tool" class="ml-2 text-purple-dark">
                            üîß <span x-text="element.config?.tool || ''"></span>
                        </span>
                    </div>

                    <!-- Maker.js Parameters Panel -->
                    <div x-show="element.type === 'maker'" class="mt-2" x-data="{showMakerParams: false}">
                        <button @click="showMakerParams = !showMakerParams"
                            class="text-xs px-2 py-1 bg-blue-100 hover:bg-blue-200 rounded flex items-center gap-1">
                            <span x-text="showMakerParams ? 'üîΩ' : 'üî∑'"></span>
                            <span>Par√°metros Maker.js</span>
                        </button>

                        <div x-show="showMakerParams" x-transition class="mt-2 p-3 bg-blue-ultra-pale rounded-lg space-y-2">
                            <!-- Rectangle / RoundRectangle -->
                            <template x-if="element.makerType === 'Rectangle' || element.makerType === 'RoundRectangle'">
                                <div class="space-y-2">
                                    <div class="grid grid-cols-2 gap-2">
                                        <div>
                                            <label class="text-xs text-gray-600">Ancho:</label>
                                            <input type="number" x-model.number="element.makerParams.width" step="1"
                                                class="w-full px-2 py-1 border rounded text-xs">
                                        </div>
                                        <div>
                                            <label class="text-xs text-gray-600">Alto:</label>
                                            <input type="number" x-model.number="element.makerParams.height" step="1"
                                                class="w-full px-2 py-1 border rounded text-xs">
                                        </div>
                                    </div>
                                    <div x-show="element.makerType === 'RoundRectangle'">
                                        <label class="text-xs text-gray-600">Radio esquinas:</label>
                                        <input type="number" x-model.number="element.makerParams.radius" step="0.5"
                                            class="w-full px-2 py-1 border rounded text-xs">
                                    </div>
                                </div>
                            </template>

                            <!-- Square -->
                            <template x-if="element.makerType === 'Square'">
                                <div>
                                    <label class="text-xs text-gray-600">Lado:</label>
                                    <input type="number" x-model.number="element.makerParams.side" step="1"
                                        class="w-full px-2 py-1 border rounded text-xs">
                                </div>
                            </template>

                            <!-- Polygon -->
                            <template x-if="element.makerType === 'Polygon'">
                                <div class="space-y-2">
                                    <div class="grid grid-cols-2 gap-2">
                                        <div>
                                            <label class="text-xs text-gray-600">Lados:</label>
                                            <input type="number" x-model.number="element.makerParams.numberOfSides" min="3"
                                                class="w-full px-2 py-1 border rounded text-xs">
                                        </div>
                                        <div>
                                            <label class="text-xs text-gray-600">Radio:</label>
                                            <input type="number" x-model.number="element.makerParams.radius" step="1"
                                                class="w-full px-2 py-1 border rounded text-xs">
                                        </div>
                                    </div>
                                </div>
                            </template>

                            <!-- Star -->
                            <template x-if="element.makerType === 'Star'">
                                <div class="space-y-2">
                                    <div>
                                        <label class="text-xs text-gray-600">Puntas:</label>
                                        <input type="number" x-model.number="element.makerParams.numberOfPoints" min="3"
                                            class="w-full px-2 py-1 border rounded text-xs">
                                    </div>
                                    <div class="grid grid-cols-2 gap-2">
                                        <div>
                                            <label class="text-xs text-gray-600">Radio ext.:</label>
                                            <input type="number" x-model.number="element.makerParams.outerRadius" step="1"
                                                class="w-full px-2 py-1 border rounded text-xs">
                                        </div>
                                        <div>
                                            <label class="text-xs text-gray-600">Radio int.:</label>
                                            <input type="number" x-model.number="element.makerParams.innerRadius" step="1"
                                                class="w-full px-2 py-1 border rounded text-xs">
                                        </div>
                                    </div>
                                </div>
                            </template>

                            <!-- Ring -->
                            <template x-if="element.makerType === 'Ring'">
                                <div class="grid grid-cols-2 gap-2">
                                    <div>
                                        <label class="text-xs text-gray-600">Radio ext.:</label>
                                        <input type="number" x-model.number="element.makerParams.outerRadius" step="1"
                                            class="w-full px-2 py-1 border rounded text-xs">
                                    </div>
                                    <div>
                                        <label class="text-xs text-gray-600">Radio int.:</label>
                                        <input type="number" x-model.number="element.makerParams.innerRadius" step="1"
                                            class="w-full px-2 py-1 border rounded text-xs">
                                    </div>
                                </div>
                            </template>

                            <!-- Ellipse -->
                            <template x-if="element.makerType === 'Ellipse'">
                                <div class="grid grid-cols-2 gap-2">
                                    <div>
                                        <label class="text-xs text-gray-600">Radio X:</label>
                                        <input type="number" x-model.number="element.makerParams.radiusX" step="1"
                                            class="w-full px-2 py-1 border rounded text-xs">
                                    </div>
                                    <div>
                                        <label class="text-xs text-gray-600">Radio Y:</label>
                                        <input type="number" x-model.number="element.makerParams.radiusY" step="1"
                                            class="w-full px-2 py-1 border rounded text-xs">
                                    </div>
                                </div>
                            </template>

                            <!-- Oval -->
                            <template x-if="element.makerType === 'Oval'">
                                <div class="grid grid-cols-2 gap-2">
                                    <div>
                                        <label class="text-xs text-gray-600">Ancho:</label>
                                        <input type="number" x-model.number="element.makerParams.width" step="1"
                                            class="w-full px-2 py-1 border rounded text-xs">
                                    </div>
                                    <div>
                                        <label class="text-xs text-gray-600">Alto:</label>
                                        <input type="number" x-model.number="element.makerParams.height" step="1"
                                            class="w-full px-2 py-1 border rounded text-xs">
                                    </div>
                                </div>
                            </template>

                            <!-- BoltCircle -->
                            <template x-if="element.makerType === 'BoltCircle'">
                                <div class="space-y-2">
                                    <div class="grid grid-cols-3 gap-2">
                                        <div>
                                            <label class="text-xs text-gray-600">Radio tornillo:</label>
                                            <input type="number" x-model.number="element.makerParams.boltRadius" step="0.5"
                                                class="w-full px-2 py-1 border rounded text-xs">
                                        </div>
                                        <div>
                                            <label class="text-xs text-gray-600">Radio agujero:</label>
                                            <input type="number" x-model.number="element.makerParams.holeRadius" step="1"
                                                class="w-full px-2 py-1 border rounded text-xs">
                                        </div>
                                        <div>
                                            <label class="text-xs text-gray-600">Cantidad:</label>
                                            <input type="number" x-model.number="element.makerParams.boltCount" min="3"
                                                class="w-full px-2 py-1 border rounded text-xs">
                                        </div>
                                    </div>
                                </div>
                            </template>

                            <!-- Regenerate Button -->
                            <button @click="regenerateMakerModel(element.id)"
                                class="w-full text-xs bg-blue-500 hover:bg-blue-600 text-white px-3 py-2 rounded mt-2">
                                üîÑ Regenerar Modelo
                            </button>
                        </div>
                    </div>

                    <!-- Children (c√≥digo actual de desglosado) -->
                    <!-- ... mantener igual ... -->
                </div>
            </template>
        </div>

        <!-- Bot√≥n Generar G-code - Sticky al final -->
        <div class="sticky bottom-0 left-0 right-0 bg-white border-t border-gray-200 p-2 shadow-lg mt-4">
            <button @click="generateGCode"
                :disabled="elements.length === 0"
                :class="elements.length > 0 ? 'bg-gradient-to-r from-blue-500 to-purple-500 hover:from-blue-600 hover:to-purple-600' : 'bg-gray-300 cursor-not-allowed'"
                class="w-full flex items-center justify-center gap-2 text-white px-3 py-2 rounded-lg text-sm font-medium transition shadow-md">
                <span class="text-base">‚öôÔ∏è</span>
                <span>Generar G-code</span>
            </button>
        </div>
    </div>
</div>

                            <!-- Jog Tab -->
                            <div x-show="currentTab === 'jog'"
                                class="space-y-6">
                                <div>
                                    <h3
                                        class="text-sm font-semibold text-purple-dark mb-3">Distancia</h3>
                                    <div class="flex gap-2">
                                        <template
                                            x-for="dist in [0.1, 1, 10, 100]"
                                            :key="dist">
                                            <button @click="jogDistance = dist"
                                                :class="jogDistance === dist ? 'bg-purple-medium text-white' : 'bg-gray-100'"
                                                class="flex-1 py-2 rounded-lg font-medium text-sm transition"
                                                x-text="dist"></button>
                                        </template>
                                    </div>
                                    <span
                                        class="text-xs text-gray-500 mt-1">mm</span>
                                </div>

                                <div>
                                    <h3
                                        class="text-sm font-semibold text-purple-dark mb-3">Velocidad</h3>
                                    <input type="range" x-model="jogSpeed"
                                        min="100" max="5000" step="100"
                                        class="w-full">
                                    <div
                                        class="flex justify-between text-xs text-gray-600 mt-1">
                                        <span>100</span>
                                        <span x-text="jogSpeed + ' mm/min'"
                                            class="font-semibold"></span>
                                        <span>5000</span>
                                    </div>
                                </div>

                                <div>
                                    <div class="grid grid-cols-3 gap-2 mb-2">
                                        <div></div>
                                        <button @click="jog('Y', jogDistance)"
                                            class="aspect-square bg-purple-ultra-pale hover:bg-purple-pale rounded-lg flex items-center justify-center text-2xl transition">
                                            ‚ñ≤
                                        </button>
                                        <div></div>
                                        <button @click="jog('X', -jogDistance)"
                                            class="aspect-square bg-purple-ultra-pale hover:bg-purple-pale rounded-lg flex items-center justify-center text-2xl transition">
                                            ‚óÑ
                                        </button>
                                        <button @click="sendCommand('$H')"
                                            class="aspect-square bg-purple-medium text-white hover:bg-purple-dark rounded-lg flex items-center justify-center text-2xl transition">
                                            ‚åÇ
                                        </button>
                                        <button @click="jog('X', jogDistance)"
                                            class="aspect-square bg-purple-ultra-pale hover:bg-purple-pale rounded-lg flex items-center justify-center text-2xl transition">
                                            ‚ñ∫
                                        </button>
                                        <div></div>
                                        <button @click="jog('Y', -jogDistance)"
                                            class="aspect-square bg-purple-ultra-pale hover:bg-purple-pale rounded-lg flex items-center justify-center text-2xl transition">
                                            ‚ñº
                                        </button>
                                    </div>

                                    <div class="grid grid-cols-2 gap-2 mt-4">
                                        <button @click="jog('Z', jogDistance)"
                                            class="bg-blue-500 hover:bg-blue-600 text-white py-3 rounded-lg font-medium transition">
                                            Z ‚ñ≤
                                        </button>
                                        <button @click="jog('Z', -jogDistance)"
                                            class="bg-blue-500 hover:bg-blue-600 text-white py-3 rounded-lg font-medium transition">
                                            Z ‚ñº
                                        </button>
                                    </div>
                                </div>

                                <div class="space-y-2">
                                    <button @click="sendCommand('G0 X0 Y0 Z0')"
                                        class="w-full bg-gray-200 hover:bg-gray-300 py-2 rounded-lg text-sm transition">
                                        Ir a Origen
                                    </button>
                                    <button
                                        @click="sendCommand('G38.2 Z-20 F100')"
                                        class="w-full bg-gray-200 hover:bg-gray-300 py-2 rounded-lg text-sm transition">
                                        Probe Z
                                    </button>
                                </div>

                                <!-- Enviar G-code -->
                                <div class="pt-4 border-t border-gray-200">
                                    <button @click="sendToGRBL"
                                        :disabled="!connected || !gcodeGenerated"
                                        :class="connected && gcodeGenerated ? 'bg-green-500 hover:bg-green-600' : 'bg-gray-300 cursor-not-allowed'"
                                        class="w-full flex items-center justify-center gap-2 text-white px-4 py-3 rounded-lg font-medium transition">
                                        <span>‚ñ∂Ô∏è</span>
                                        <span>Enviar a M√°quina</span>
                                    </button>
                                </div>
                            </div>

                            <!-- G-code Tab -->
                            <div x-show="currentTab === 'gcode'"
                                class="space-y-4">
                                <div class="flex items-center justify-between">
                                    <h3
                                        class="text-sm font-semibold text-purple-dark">G-code
                                        Generado</h3>
                                    <span class="text-xs text-gray-600"
                                        x-text="gcodeLines + ' l√≠neas'"></span>
                                </div>
                                <textarea x-model="gcode"
                                    readonly
                                    class="w-full h-96 px-3 py-2 bg-purple-bg border border-gray-300 rounded-lg font-mono text-xs"
                                    placeholder="El G-code aparecer√° aqu√≠..."></textarea>

                                <!-- Botones de Guardar y Descargar -->
                                <div class="flex gap-3">
                                    <button @click="downloadGCode"
                                        :disabled="!gcodeGenerated"
                                        :class="gcodeGenerated ? 'bg-green-500 hover:bg-green-600' : 'bg-gray-300 cursor-not-allowed'"
                                        class="flex-1 flex items-center justify-center gap-2 text-white px-4 py-3 rounded-lg font-medium transition">
                                        <span>üíæ</span>
                                        <span>Descargar G-code</span>
                                    </button>
                                    <button @click="alert('Guardar en nube - En desarrollo')"
                                        :disabled="!gcodeGenerated"
                                        :class="gcodeGenerated ? 'bg-blue-500 hover:bg-blue-600' : 'bg-gray-300 cursor-not-allowed'"
                                        class="flex-1 flex items-center justify-center gap-2 text-white px-4 py-3 rounded-lg font-medium transition">
                                        <span>‚òÅÔ∏è</span>
                                        <span>Guardar</span>
                                    </button>
                                </div>

                                <div x-show="sending" class="space-y-2">
                                    <div
                                        class="w-full bg-gray-200 rounded-full h-2 overflow-hidden">
                                        <div
                                            class="bg-green-500 h-2 transition-all duration-300"
                                            :style="'width: ' + sendProgress + '%'"></div>
                                    </div>
                                    <p class="text-sm text-center text-gray-600"
                                        x-text="sendProgress.toFixed(1) + '%'"></p>
                                </div>
                            </div>

                            <!-- 3D Viewer Tab -->
                            <div x-show="currentTab === 'viewer'"
                                class="space-y-4">
                                <div class="flex items-center justify-between">
                                    <h3
                                        class="text-sm font-semibold text-purple-dark">Controles
                                        Visor 3D</h3>
                                    <button @click="resetViewer3D"
                                        class="text-xs px-3 py-1 bg-purple-ultra-pale hover:bg-purple-pale rounded transition"
                                        title="Resetear vista">
                                        üîÑ Resetear
                                    </button>
                                </div>

                                <!-- Quick Info -->
                                <div class="bg-purple-ultra-pale rounded-lg p-3 text-xs">
                                    <p class="text-gray-700">
                                        üí° <strong>Tip:</strong> Usa el bot√≥n "üé¨ Vista 3D" en el √°rea superior
                                        para cambiar entre el dise√±o SVG y la previsualizaci√≥n 3D.
                                    </p>
                                </div>

                                <!-- Statistics -->
                                <div class="bg-purple-ultra-pale rounded-lg p-3 text-xs space-y-2">
                                    <div class="grid grid-cols-2 gap-2">
                                        <div>
                                            <span class="text-gray-600">Distancia total:</span>
                                            <span class="font-semibold text-purple-dark ml-1"
                                                x-text="viewer3DStats.distance"></span>
                                        </div>
                                        <div>
                                            <span class="text-gray-600">Tiempo estimado:</span>
                                            <span class="font-semibold text-purple-dark ml-1"
                                                x-text="viewer3DStats.time"></span>
                                        </div>
                                        <div>
                                            <span class="text-gray-600">Pasadas:</span>
                                            <span class="font-semibold text-purple-dark ml-1"
                                                x-text="viewer3DStats.passes"></span>
                                        </div>
                                        <div>
                                            <span class="text-gray-600">L√≠neas G-code:</span>
                                            <span class="font-semibold text-purple-dark ml-1"
                                                x-text="gcodeLines"></span>
                                        </div>
                                    </div>
                                </div>

                                <!-- Bot√≥n Enviar a GRBL -->
                                <button @click="sendToGRBL"
                                    :disabled="!connected || !gcodeGenerated"
                                    :class="connected && gcodeGenerated ? 'bg-green-500 hover:bg-green-600' : 'bg-gray-300 cursor-not-allowed'"
                                    class="w-full flex items-center justify-center gap-2 text-white px-4 py-3 rounded-lg font-medium transition">
                                    <span>‚ñ∂Ô∏è</span>
                                    <span>Enviar a M√°quina</span>
                                </button>

                                <!-- Layer/Pass Control -->
                                <div x-show="viewer3DStats.passes > 1"
                                    class="bg-white border rounded-lg p-3 space-y-2">
                                    <div class="flex items-center justify-between text-xs">
                                        <span class="font-semibold text-purple-dark">Vista de Pasadas</span>
                                        <span class="text-gray-600"
                                            x-text="'Pasada ' + viewer3DCurrentPass + '/' + viewer3DStats.passes"></span>
                                    </div>
                                    <input type="range"
                                        x-model.number="viewer3DCurrentPass"
                                        @input="updateViewer3DPass()"
                                        min="0"
                                        :max="viewer3DStats.passes"
                                        class="w-full">
                                    <div class="flex justify-between text-xs text-gray-500">
                                        <span>Todas</span>
                                        <span x-text="viewer3DStats.passes"></span>
                                    </div>
                                </div>

                                <!-- Animation Controls -->
                                <div class="bg-white border rounded-lg p-3 space-y-2">
                                    <div class="flex items-center justify-between text-xs mb-2">
                                        <span class="font-semibold text-purple-dark">Simulaci√≥n</span>
                                        <span class="text-gray-600"
                                            x-text="viewer3DAnimProgress + '%'"></span>
                                    </div>

                                    <!-- Progress bar -->
                                    <div class="w-full bg-gray-200 rounded-full h-2 overflow-hidden">
                                        <div class="bg-purple-medium h-2 transition-all duration-300"
                                            :style="'width: ' + viewer3DAnimProgress + '%'"></div>
                                    </div>

                                    <!-- Control buttons -->
                                    <div class="flex gap-2">
                                        <button @click="playViewer3D"
                                            :class="viewer3DPlaying ? 'bg-gray-300' : 'bg-green-500 hover:bg-green-600'"
                                            :disabled="viewer3DPlaying"
                                            class="flex-1 text-white px-3 py-2 rounded-lg text-xs transition">
                                            ‚ñ∂ Play
                                        </button>
                                        <button @click="pauseViewer3D"
                                            :class="!viewer3DPlaying ? 'bg-gray-300' : 'bg-yellow-500 hover:bg-yellow-600'"
                                            :disabled="!viewer3DPlaying"
                                            class="flex-1 text-white px-3 py-2 rounded-lg text-xs transition">
                                            ‚è∏ Pause
                                        </button>
                                        <button @click="stopViewer3D"
                                            class="flex-1 bg-red-500 hover:bg-red-600 text-white px-3 py-2 rounded-lg text-xs transition">
                                            ‚èπ Stop
                                        </button>
                                    </div>

                                    <!-- Speed control -->
                                    <div class="flex items-center gap-2 text-xs">
                                        <span class="text-gray-600">Velocidad:</span>
                                        <input type="range"
                                            x-model.number="viewer3DSpeed"
                                            @input="watchViewer3DSpeed()"
                                            min="0.1" max="5" step="0.1"
                                            class="flex-1">
                                        <span class="font-semibold text-purple-dark w-8"
                                            x-text="viewer3DSpeed + 'x'"></span>
                                    </div>
                                </div>

                                <!-- Legend -->
                                <div class="bg-white border rounded-lg p-3">
                                    <div class="text-xs font-semibold text-purple-dark mb-2">Leyenda</div>
                                    <div class="flex flex-wrap gap-3 text-xs">
                                        <div class="flex items-center gap-1">
                                            <div class="w-6 h-2 bg-blue-500 rounded"></div>
                                            <span class="text-gray-600">R√°pido (G0)</span>
                                        </div>
                                        <div class="flex items-center gap-1">
                                            <div class="w-6 h-2 bg-red-500 rounded"></div>
                                            <span class="text-gray-600">Corte (G1)</span>
                                        </div>
                                        <div class="flex items-center gap-1">
                                            <div class="w-3 h-3 bg-yellow-400 rounded-full"></div>
                                            <span class="text-gray-600">Herramienta</span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Console Tab -->
                            <div x-show="currentTab === 'console'"
                                class="space-y-4">
                                <div class="flex items-center justify-between">
                                    <h3
                                        class="text-sm font-semibold text-purple-dark">Consola
                                        GRBL</h3>
                                    <button @click="clearConsole"
                                        class="text-xs text-gray-600 hover:text-purple-medium">
                                        Limpiar
                                    </button>
                                </div>
                                <div x-ref="consoleOutput"
                                    class="h-96 bg-gray-900 rounded-lg p-3 overflow-y-auto font-mono text-xs text-green-400">
                                    <template
                                        x-for="(line, index) in consoleLines"
                                        :key="index">
                                        <div x-text="line"></div>
                                    </template>
                                </div>
                                <div class="flex gap-2">
                                    <input type="text"
                                        x-model="consoleInput"
                                        @keyup.enter="sendConsoleCommand"
                                        :disabled="!connected"
                                        class="flex-1 px-3 py-2 border border-gray-300 rounded-lg text-sm"
                                        placeholder="Comando manual...">
                                    <button @click="sendConsoleCommand"
                                        :disabled="!connected"
                                        class="bg-purple-medium hover:bg-purple-dark text-white px-4 py-2 rounded-lg text-sm transition disabled:bg-gray-300">
                                        Enviar
                                    </button>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>
            </main>
